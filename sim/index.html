<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Christmas Card 2021 Simulator</title>

    <style>
        #canvas {
            display: block;
            margin: auto;
            border: solid 1px lightgray;
        }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>

<script type="application/javascript">

    const canvas = document.querySelector("#canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 800;
    canvas.height = 800;
    canvas.style.width = "400px";
    canvas.style.height = "400px";
    ctx.scale(8, 8);
    ctx.lineWidth = 0.1;
    ctx.font = "2px Arial";
    ctx.fillStyle = "gray";

    function radToDeg(a) {
        return a / Math.PI * 180;
    }

    function anglePoints(a, b) {
        return Math.atan((a.y - b.y) / (b.x - a.x));
    }

    function pointOnCircle(center, radius, angle) {
        const dx = Math.sin(angle) * radius;
        const dy = Math.cos(angle) * radius;
        return {
            x: center.x + dx,
            y: center.y + dy,
        };
    }

    function drawLED(ctx, point, index) {
        ctx.beginPath();
        ctx.arc(point.x, point.y, 1, 0, 2 * Math.PI);
        ctx.stroke();
        ctx.fillText(`D${index}`, point.x + 1.5, point.y);
        // ctx.fillText(`(${ point.x.toFixed(1) }, ${ (100 - point.y).toFixed(1) })`, point.x + 1, point.y);
    }

    const center = {x: 50, y: 50};



    function draw() {

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const indexOrder = [
            27, 23, 10, 5, 46, 37,
            28, 24, 11, 4, 47, 38,
            30, 25, 12, 3, 48, 39,
            33, 13, 17, 2, 51, 42,
            34, 14, 18, 1, 52, 43,
            35, 31, 20, 26, 19, 15, 8, 6, 53, 49, 44, 40,
            36, 32, 21, 29, 22, 16, 9, 7, 54, 50, 45, 41,
        ];

        for (let radius = 9; radius <= 50; radius += 9) {
            for (let i = 0; i < 6; i++) {
                const angle = 2 * i * Math.PI / 6;
                const point = pointOnCircle(center, radius, angle);
                drawLED(ctx, point, indexOrder.shift());
            }
        }

        const radius1 = 35;
        const radius2 = 42;

        for (let i = 0; i < 6; i++) {
            const angle = 2 * i * Math.PI / 6;
            const point1 = pointOnCircle(center, radius1, angle - 0.2);
            const point2 = pointOnCircle(center, radius1, angle + 0.2);
            drawLED(ctx, point1, indexOrder.shift());
            drawLED(ctx, point2, indexOrder.shift());
            // const point3 = pointOnCircle(center, radius2, angle - 0.35);
            // const point4 = pointOnCircle(center, radius2, angle + 0.35);
            // ctx.fillText(`(${ radToDeg(anglePoints(point1, point3)).toFixed(1) })`, point3.x + 1, point3.y);
            // ctx.fillText(`(${ radToDeg(anglePoints(point2, point4)).toFixed(1) })`, point4.x + 1, point4.y);
        }

        for (let i = 0; i < 6; i++) {
            const angle = 2 * i * Math.PI / 6;
            const point1 = pointOnCircle(center, radius2, angle - 0.35);
            const point2 = pointOnCircle(center, radius2, angle + 0.35);
            drawLED(ctx, point1, indexOrder.shift());
            drawLED(ctx, point2, indexOrder.shift());
        }

    }

    draw();

</script>

</body>
</html>